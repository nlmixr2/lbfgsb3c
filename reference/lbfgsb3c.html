<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver."><title>Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver. — lbfgsb3c • lbfgsb3c</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver. — lbfgsb3c"><meta property="og:description" content="Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lbfgsb3c</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2024-3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/lbfgsb3c.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixr2/lbfgsb3c/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver.</h1>
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/lbfgsb3c/blob/HEAD/R/lbfgsb3.R" class="external-link"><code>R/lbfgsb3.R</code></a></small>
      <div class="d-none name"><code>lbfgsb3c.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lbfgsb3c</span><span class="op">(</span></span>
<span>  <span class="va">par</span>,</span>
<span>  <span class="va">fn</span>,</span>
<span>  gr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  rho <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lbfgsb3</span><span class="op">(</span></span>
<span>  <span class="va">par</span>,</span>
<span>  <span class="va">fn</span>,</span>
<span>  gr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  rho <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lbfgsb3f</span><span class="op">(</span></span>
<span>  <span class="va">par</span>,</span>
<span>  <span class="va">fn</span>,</span>
<span>  gr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  rho <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lbfgsb3x</span><span class="op">(</span></span>
<span>  <span class="va">par</span>,</span>
<span>  <span class="va">fn</span>,</span>
<span>  gr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  rho <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>par</dt>
<dd><p>A parameter vector which gives the initial guesses to
the parameters that will minimize <code>fn</code>. This can be
named, for example, we could use par=c(b1=1, b2=2.345,
b3=0.123)</p></dd>


<dt>fn</dt>
<dd><p>A function that evaluates the objective function to be
minimized.  This can be a R function or a Rcpp function
pointer.</p></dd>


<dt>gr</dt>
<dd><p>If present, a function that evaluates the gradient
vector for the objective function at the given parameters
computing the elements of the sum of squares function at the
set of parameters <code>start</code>. This can be a R function or a
Rcpp function pointer.</p></dd>


<dt>lower</dt>
<dd><p>Lower bounds on the parameters. If a single number,
this will be applied to all parameters. Default -Inf.</p></dd>


<dt>upper</dt>
<dd><p>Upper bounds on the parameters. If a single number,
this will be applied to all parameters. Default Inf.</p></dd>


<dt>control</dt>
<dd><p>An optional list of control settings. See below in
details.</p></dd>


<dt>...</dt>
<dd><p>Any data needed for computation of the objective
function and gradient.</p></dd>


<dt>rho</dt>
<dd><p>An Environment to use for function evaluation.  If
present the arguments in ... are ignored.  Otherwise the
... are converted to an environment for evaluation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of the following items</p><ul><li><p>par The best set of parameters found.</p></li>
<li><p>value The value of fn corresponding to par.</p></li>
<li><p>counts A two-element integer vector giving the number of calls to fn and gr respectively. This excludes any calls to fn to compute a finite-difference approximation to the gradient.</p></li>
<li><p>convergence An integer code. 0 indicates successful completion</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See the notes below for a general appreciation of this package.</p>
<p>The control list can contain:</p><ul><li><p>trace If positive, tracing information on the progress of the optimization is produced. Higher values may produce more tracing information: for method "L-BFGS-B" there are six levels of tracing. (To understand exactly what these do see the source code: higher levels give more detail.)</p></li>
<li><p>factr controls the convergence of the "L-BFGS-B" method. Convergence occurs when the reduction in the objective is within this factor of the machine tolerance. Default is 1e7, that is a tolerance of about 1e-8.</p></li>
<li><p>pgtol helps control the convergence of the "L-BFGS-B" method. It is a tolerance on the projected gradient in the current search direction. This defaults to zero, when the check is suppressed.</p></li>
<li><p>abstol helps control the convergence of the "L-BFGS-B" method. It is an absolute tolerance difference in x values. This defaults to zero, when the check is suppressed.</p></li>
<li><p>reltol helps control the convergence of the "L-BFGS-B" method. It is an relative tolerance difference in x values. This defaults to zero, when the check is suppressed.</p></li>
<li><p>lmm is an integer giving the number of BFGS updates retained in the "L-BFGS-B" method, It defaults to 5.</p></li>
<li><p>maxit maximum number of iterations.</p></li>
<li><p>iprint Provided only for compatibility with older codes. This control is no longer active.)</p></li>
<li><p>info a boolean to indicate if more optimization information is captured and output in a $info list</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This package is a wrapper to the Fortran code released by Nocedal and Morales.
  This poses several difficulties for an R package. While the <code><a href="https://rdrr.io/r/base/Foreign.html" class="external-link">.Fortran()</a></code>
  tool exists for the interfacing, we must be very careful to align the arguments
  with those of the Fortran subroutine, especially in type and storage.</p>
<p>A more annoying task for interfacing the Fortran code is that Fortran WRITE or
  PRINT statements must all be replaced with calls to special R-friendly output
  routines. Unfortunately, the Fortran is full of output statements. Worse, we may
  wish to be able to suppress such output, and there are thus many modifications
  to be made. This means that an update of the original code cannot be simply
  plugged into the R package <code>src</code> directory.</p>
<p>Finally, and likely because L-BFGS-B has a long history, the Fortran code is far
  from well-structured. For example, the number of function and gradient evaluations
  used is returned as the 34'th element of an integer vector. There does not appear
  to be an easy way to stop the program after some maximum number of such evaluations
  have been performed.</p>
<p>On the other hand, the version of L-BFGS-B in <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> is a <code>C</code> translation
  of a now-lost Fortran code. It does not implement the improvements Nocedal and
  Morales published in 2011. Hence, despite its deficiencies, this wrapper has been
  prepared.</p>
<p>In addition to the above reasons for the original lbfgsb3 package,
this additional package allows C calling of L-BFGS-B 3.0 by a
program as well as adjustments to the tolerances that were not
present in the original CRAN package.  Also adjustments were made
to have outputs conform with R's optim routine.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Morales, J. L.; Nocedal, J. (2011). "Remark on 'algorithm 778: L-BFGS-B:
          Fortran subroutines for large-scale bound constrained optimization' ".
          ACM Transactions on Mathematical Software 38: 1.</p>
<p>Byrd, R. H.; Lu, P.; Nocedal, J.; Zhu, C. (1995). "A Limited Memory Algorithm
          for Bound Constrained Optimization". SIAM J. Sci. Comput. 16 (5): 1190-1208.</p>
<p>Zhu, C.; Byrd, Richard H.; Lu, Peihuang; Nocedal, Jorge (1997). "L-BFGS-B:
          Algorithm 778: L-BFGS-B, FORTRAN routines for large scale bound constrained
          optimization". ACM Transactions on Mathematical Software 23 (4): 550-560.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Packages <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> and <code>optimx</code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Matthew Fidler (move to C and add more options for adjustments),
    John C Nash &lt;nashjc@uottawa.ca&gt; (of the wrapper and edits to Fortran code to allow R output)
    Ciyou Zhu, Richard Byrd, Jorge Nocedal, Jose Luis Morales (original Fortran packages)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Rosenbrock's banana function</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">3</span>; <span class="va">p</span><span class="op">=</span><span class="fl">100</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fr</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">f</span><span class="op">=</span><span class="fl">1.0</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">f</span><span class="op">=</span><span class="va">f</span><span class="op">+</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">+</span><span class="op">(</span><span class="fl">1.0</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">f</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">grr</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">g</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="op">-</span><span class="fl">4.0</span><span class="op">*</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span><span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="va">g</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="fl">2.0</span><span class="op">*</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">-</span><span class="fl">4.0</span><span class="op">*</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="fl">2.0</span><span class="op">*</span><span class="op">(</span><span class="fl">1.0</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">g</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">=</span><span class="fl">2.0</span><span class="op">*</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">-</span><span class="fl">2.0</span><span class="op">*</span><span class="op">(</span><span class="fl">1.0</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">g</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1.02</span>, b<span class="op">=</span><span class="fl">1.02</span>, c<span class="op">=</span><span class="fl">1.02</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">opc</span> <span class="op">&lt;-</span> <span class="fu">lbfgsb3c</span><span class="op">(</span><span class="va">x</span>,<span class="va">fr</span>, <span class="va">grr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a b c </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $grad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             a             b             c </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.355657e-06  2.678768e-06 -8.399731e-07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="op">(</span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu">lbfgsb3</span><span class="op">(</span><span class="va">x</span>,<span class="va">fr</span>, <span class="va">grr</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 0 f=1.084032 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 2 f=144.115766 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 3 f=1.003318 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 4 f=1.000877 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 5 f=1.000876 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 6 f=1.000866 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 7 f=1.000863 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 8 f=1.000854 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 9 f=1.000810 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 10 f=1.000655 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 11 f=1.000427 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 12 f=1.000135 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 13 f=1.000079 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 14 f=1.000002 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 15 f=1.000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 16 f=1.000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 17 f=1.000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At iteration 18 f=1.000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a b c </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $grad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             a             b             c </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.355657e-06  2.678768e-06 -8.399731e-07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$task</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$itask</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$lsave</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE FALSE FALSE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$icsave</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$dsave</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  6.504997e+02  1.000000e+00  2.220446e-09  2.615484e-06  2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11]  3.331497e-14  1.000000e+10  2.678768e-06  1.000000e+00 -1.927531e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16]  6.840757e-12 -1.927531e-11 -1.927531e-14 -1.927531e-11 -1.927531e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21]  1.000000e+00  1.000000e+00  1.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26]  0.000000e+00  5.000000e+00  1.000000e+10  2.000000e+10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$isave</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  15  25 100   1  16  31  56  81 106 206 306 309 312 315 318 321   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20]   0   0   1   0   8   0   0   4   5   3  14  13   0   0  18   0   1   0   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39]   0   4   0   0   0   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="op">(</span><span class="va">opx</span> <span class="op">&lt;-</span> <span class="fu">lbfgsb3x</span><span class="op">(</span><span class="va">x</span>,<span class="va">fr</span>, <span class="va">grr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a b c </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $grad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             a             b             c </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.355657e-06  2.678768e-06 -8.399731e-07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="op">(</span><span class="va">opf</span> <span class="op">&lt;-</span> <span class="fu">lbfgsb3f</span><span class="op">(</span><span class="va">x</span>,<span class="va">fr</span>, <span class="va">grr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a b c </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $grad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             a             b             c </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.355657e-06  2.678768e-06 -8.399731e-07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$task</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$itask</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$lsave</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE FALSE FALSE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$icsave</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$dsave</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  6.504997e+02  1.000000e+00  2.220446e-09  2.615484e-06  2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11]  3.331497e-14  1.000000e+10  2.678768e-06  1.000000e+00 -1.927531e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16]  6.840757e-12 -1.927531e-11 -1.927531e-14 -1.927531e-11 -1.927531e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21]  1.000000e+00  1.000000e+00  1.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26]  0.000000e+00  5.000000e+00  1.000000e+10  2.000000e+10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info$isave</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  15  25 100   1  16  31  56  81 106 206 306 309 312 315 318 321   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20]   0   0   1   0   8   0   0   4   5   3  14  13   0   0  18   0   1   0   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39]   0   4   0   0   0   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Matthew L Fidler, John C Nash, Ciyou Zhu, Richard Byrd, Jorge Nocedal, Jose Luis Morales.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

